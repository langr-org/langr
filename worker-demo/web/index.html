<!doctype html>
<html>
<head>
<title>WebSocket Demo</title>
<meta charset="UTF-8">
<!--script src="https://code.jquery.com/jquery-3.5.1.min.js"></script-->
<script src="js/jquery-3.5.1.js"></script>
<script src="js/jqwebsocket.js"></script>
<style>
body {
    /*transform: rotate(90deg);*/
}
#content {
    /*height: 600px;*/
    height: 37.5rem;
    width: 31.25rem;
    overflow-y: scroll;
}
#help {
    height: 37.5rem;
    width: 18.75rem;
    position: relative;
    left: 33rem;
    top: -37.5rem;
}
</style>
</head>
<body>

<h1>WebSocket Demo - Dagong</h1>
<!-- <section id="content"></section> -->
<div id="content"></div>
<input id="message" type="text" style="width:19rem"/>
<script>
//$('#content').scrollTop = $('#content').scrollHeight;
var divscroll = document.getElementById('content');
divscroll.scrollTop = divscroll.scrollHeight;
var host = document.domain;

var ws = $.websocket({
    url: "ws://" + host + ":8765/?token=abcdef",
    onMessage: function(e) { 
        $('#content').append(e + ' ' + '<br>');
    }
});
$('#message').change(function(){
    ws.send(this.value);
    this.value = '';
    divscroll.scrollTop = divscroll.scrollHeight;
    console.log('scrollHeight' + divscroll.scrollHeight);
});
</script>
<div id="help"><iframe src='api.txt' style="height:37.5rem"> </iframe></div>
</body>
</html>
