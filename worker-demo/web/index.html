<!doctype html>
<html>
<head>
<title>WebSocket Demo</title>
<meta charset="UTF-8">
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="js/jqwebsocket.js"></script>
<style>
    #content {
        height: 600px;
        width: 500px;
        overflow-y: scroll;
    }
    #help {
        height: 600px;
        width: 300px;
        position: relative;
        left: 530px;
        top: -600px;
    }
</style>
</head>
<body>

<h1>WebSocket Demo - Dagong</h1>
<!-- <section id="content"></section> -->
<div id="content"></div>
<input id="message" type="text" style="width:300px"/>
<script>
//$('#content').scrollTop = $('#content').scrollHeight;
var divscroll = document.getElementById('content');
divscroll.scrollTop = divscroll.scrollHeight;

var ws = $.websocket({
    url: "ws://127.0.0.1:8765/?token=abcdef",
    onMessage: function(e) { 
        $('#content').append(e + ' ' + '<br>');
    }
});
$('#message').change(function(){
    ws.send(this.value);
    this.value = '';
    divscroll.scrollTop = divscroll.scrollHeight;
    console.log('scrollHeight' + divscroll.scrollHeight);
});
</script>
<div id="help"><iframe src='api.txt' style="height:600px"> </iframe></div>
</body>
</html>
